<!DOCTYPE html> 
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Your Team</title>
    <link rel="stylesheet" href="formteams1.css">
</head>
<body>
    <div class="heading">
        <h1>Form Your Own Team</h1>
        <h3>Powered By BrainBridges</h3>
    </div>

    <!-- Side bar options -->
    <div class="hamburger-menu">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
    </div>

    <nav id="sidebar">
        <!-- Close button -->
        <div class="close-btn">&times;</div>
        <div class="dropdown">
            <ul>
                <!-- Filters for year, skills, languages, and college -->
                <li>
                    <a href="#" class="dropdown-toggle" id="yearToggle">Year</a>
                    <ul class="dropdown-menu year-filters" id="yearDropdown">
                        <li><label><input type="checkbox" name="year" value="1"> 1</label></li>
                        <li><label><input type="checkbox" name="year" value="2"> 2</label></li>
                        <li><label><input type="checkbox" name="year" value="3"> 3</label></li>
                        <li><label><input type="checkbox" name="year" value="4"> 4</label></li>
                    </ul>
                </li>
                <li>
                    <a href="#" class="dropdown-toggle" id="skillsToggle">Skills</a>
                    <ul class="dropdown-menu skills-filters" id="skillsDropdown">
                        <li><label><input type="checkbox" name="skills" value="AI"> AI</label></li>
                        <li><label><input type="checkbox" name="skills" value="ML"> ML</label></li>
                        <li><label><input type="checkbox" name="skills" value="Web Development"> Web Development</label></li>
                        <li><label><input type="checkbox" name="skills" value="App Development"> App Development</label></li>
                    </ul>
                </li>
                <li>
                    <a href="#" class="dropdown-toggle" id="languagesToggle">Languages</a>
                    <ul class="dropdown-menu language-filters" id="languagesDropdown">
                        <li><label><input type="checkbox" name="language" value="C/C++"> C/C++</label></li>
                        <li><label><input type="checkbox" name="language" value="Java"> Java</label></li>
                        <li><label><input type="checkbox" name="language" value="Flutter"> Flutter</label></li>
                        <li><label><input type="checkbox" name="language" value="JavaScript"> JavaScript</label></li>
                        <li><label><input type="checkbox" name="language" value="Kotlin"> Kotlin</label></li>
                        <li><label><input type="checkbox" name="language" value="Swift"> Swift</label></li>
                        <li><label><input type="checkbox" name="language" value="Go"> Go</label></li>
                    </ul>
                </li>
                <li>
                    <a href="#" class="dropdown-toggle" id="collegeToggle">College</a>
                    <ul class="dropdown-menu college-filters" id="collegeDropdown">
                        <li><label><input type="checkbox" name="college" value="Global"> Global Universities</label></li>
                        <li><label><input type="checkbox" name="college" value="Own University"> Within University</label></li>
                    </ul>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Search Bar -->
    <div class="search-container">
        <input type="text" id="searchBar" onkeyup="searchFunction()" placeholder="Search for names..">
        <button id="search-button">Search</button>
    </div>

    <div class="container" id="teamContainer">
        <% people.forEach(function(i){ %>
            <div class="box">
                <h2><%= i.name %></h2>
                <p><%= i.skills %></p>
                <button onclick="handleclick('<%= i.user_id%>')" type="button">View More</button>
            </div>
        <% }); %>
    </div>

    <script>
        // Sidebar Toggle Functionality
        const hamburger = document.querySelector('.hamburger-menu');
        const sidebar = document.getElementById('sidebar');
        const closeBtn = document.querySelector('.close-btn');

        hamburger.addEventListener('click', () => {
            sidebar.classList.toggle('active');
        });

        closeBtn.addEventListener('click', () => {
            sidebar.classList.remove('active');
        });

        // Dropdown Toggle Functionality
        document.querySelectorAll('.dropdown-toggle').forEach(function(toggle) {
            toggle.addEventListener('click', function(event) {
                event.preventDefault();
                const dropdownMenu = this.nextElementSibling;
                dropdownMenu.classList.toggle('show');

                // Close other dropdowns when one is opened
                document.querySelectorAll('.dropdown-menu').forEach(function(menu) {
                    if (menu !== dropdownMenu) {
                        menu.classList.remove('show');
                    }
                });
            });
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            document.querySelectorAll('.dropdown').forEach(function(dropdown) {
                const dropdownMenu = dropdown.querySelector('.dropdown-menu');
                if (!dropdown.contains(event.target)) {
                    dropdownMenu.classList.remove('show');
                }
            });
        });

        // Search Functionality
        function searchFunction() {
            var input, filter, container, boxes, h2, i, txtValue;
            input = document.getElementById('searchBar');
            filter = input.value.toUpperCase();
            container = document.getElementById("teamContainer");
            boxes = container.getElementsByClassName('box');

            for (i = 0; i < boxes.length; i++) {
                h2 = boxes[i].getElementsByTagName("h2")[0];
                txtValue = h2.textContent || h2.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    boxes[i].style.display = "";
                } else {
                    boxes[i].style.display = "none";
                }
            }
        }

        // Redirect function
        function handleclick(event){
            window.location.href=`/portfolio?id=${event}`;
        }

        // Filter Functionality to send data to the backend
        document.getElementById('search-button').addEventListener('click', function() {
            const skills = [...document.querySelectorAll('input[name="skills"]:checked')].map(cb => cb.value);
            const languages = [...document.querySelectorAll('input[name="language"]:checked')].map(cb => cb.value);
            const college = [...document.querySelectorAll('input[name="college"]:checked')].map(cb => cb.value);
            const year = [...document.querySelectorAll('input[name="year"]:checked')].map(cb => cb.value);

            // Send POST request with the filters
            fetch('/filter-users', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ skills, languages, college, year })
            })
            .then(response => response.json())
            .then(data => {
                // Update the UI with the filtered results (you can replace this with dynamic rendering)
                console.log(data);
            })
            .catch(error => console.error('Error:', error));
        });
    </script>
</body>
</html>
